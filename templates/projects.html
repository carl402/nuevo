{% extends "base.html" %}

{% block content %}
<h2>Proyectos</h2>

<form class="row g-3 mb-3" method="get" action="{{ url_for('projects_list') }}">
  <div class="col-auto">
    <input name="q" value="{{ q or '' }}" class="form-control" placeholder="Buscar por nombre">
  </div>
  <div class="col-auto">
    <button class="btn btn-primary">Buscar</button>
  </div>
</form>

<div class="card mb-3">
  <div class="card-body">
    <h5>Crear Proyecto</h5>
    <form method="post" action="{{ url_for('projects_create') }}">
      <div class="mb-2">
        <input name="name" placeholder="Nombre" class="form-control" required />
      </div>
      <div class="mb-2">
        <input name="description" placeholder="Descripción" class="form-control" />
      </div>
      <div class="mb-2">
        <select name="status" class="form-select">
          <option value="Activo">Activo</option>
          <option value="Inactivo">Inactivo</option>
        </select>
      </div>
      <button class="btn btn-success">Crear Proyecto</button>
    </form>
  </div>
</div>

<table class="table">
  <thead>
    <tr><th>Nombre</th><th>Descripción</th><th>Estado</th><th>Variables</th><th>Acciones</th></tr>
  </thead>
  <tbody>
    {% for p in projects %}
      <tr>
        <td>{{ p.name }}</td>
        <td>{{ p.description }}</td>
        <td>
          {% if p.status == 'Activo' %}
            <span class="badge bg-success">Activo</span>
          {% else %}
            <span class="badge bg-danger">Inactivo</span>
          {% endif %}
        </td>
        <td>{{ p.variables|length }}</td>
        <td>
          <form method="post" action="{{ url_for('projects_delete', project_id=p.id) }}" style="display:inline">
            <button class="btn btn-sm btn-danger">Eliminar</button>
          </form>
          <a class="btn btn-sm btn-primary" href="#">Configurar</a>
          <form method="post" action="{{ url_for('project_simulate', project_id=p.id) }}" style="display:inline">
            <input type="hidden" name="iterations" value="1000">
            <button class="btn btn-sm btn-outline-success">Ejecutar</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
